# INSTITUTO SUPERIOR  TECNOLOGICO QUITO
![](https://qiu.itq.edu.ec/Principal/imgLogin/loading.png)

## PROYECTO BDD NOSQL

#### Integrantes

-  Guerrero Lorena 
- Mishell Chiles
- Chav√©z Kevin
- Sanchez Juan
# GASTROVERSE ü•óüçï
Nuestro proyecto trata sobre un aplicativo web donde se va a poder publicar recetas y leerlas
#### Objetivo General
Dise√±ar e implementar una base de datos no relacional eficiente para respaldar un aplicativo web de recetas, asegurando la gesti√≥n √≥ptima de la informaci√≥n, con el fin de proporcionar una experiencia de usuario fluida y eficaz en la b√∫squeda, almacenamiento y actualizaci√≥n de recetas culinarias.
#### Marco Te√≥rico
##### ‚Äé ‚Äé ‚Äé ‚Äé ‚Äé ‚Äé‚Äé  Modelo de Datos No Relacional:
Son sistemas de gesti√≥n de bases de datos que proporcionan un enfoque diferente al modelo relacional tradicional. Los modelos NoSQL incluyen bases de datos documentales, de clave-valor, de columnas y de grafos, entre otros.
#####‚Äé ‚Äé ‚Äé ‚Äé ‚Äé ‚Äé ‚ÄéEscalabilidad y Rendimiento:
Aumentar la capacidad de una base de datos distribuyendo los datos en m√∫ltiples servidores o nodos.
#####‚Äé ‚Äé ‚Äé ‚Äé ‚Äé ‚Äé ‚ÄéSeguridad y Privacidad:
   - Pol√≠ticas de Acceso: Establecer reglas y permisos que determinan qu√© usuarios o roles tienen acceso a qu√© datos y operaciones.
   
 - Encriptaci√≥n: Aplicar t√©cnicas de encriptaci√≥n para proteger datos sensibles almacenados en la base de datos.
#####‚Äé Migraci√≥n y Actualizaci√≥n:
Se refiere al proceso de transferir datos y adaptar la estructura de la base de datos a una nueva versi√≥n o a un sistema diferente. .
#### Recursos Utlizados
- MongoDB Atlas
- Studio 3T
- Dispositivo Electronico (Computador)

# COLECCIONES
## Autentificaciones 
Srve para saber de d√≥nde est√° activa la cuenta, desde que dispositivo 
y tambi√©n para manejar el n√∫mero de intentos para asegurar la informaci√≥n del usuario.    

![](https://github.com/Mishell-0/GastroVerse/blob/main/Captura%20de%20pantalla%20(183).png?raw=true)
## Autorizaciones
 Creada para que al momento de iniciar sesi√≥n me permita ingresar 
como administrador o cliente.
![](https://github.com/Mishell-0/GastroVerse/blob/main/Captura%20de%20pantalla%20(184).png?raw=true)
## Categorias
 Nos indica el tipo de categor√≠a de nuestra receta y una breve descripci√≥n.
  ![](https://github.com/Mishell-0/GastroVerse/blob/main/Captura%20de%20pantalla%20(185).png?raw=true)
## Comentarios
 Permite al usuario dejar un comentario sobre la receta publicada con 
fecha y hora.
 ![](https://github.com/Mishell-0/GastroVerse/blob/main/Captura%20de%20pantalla%20(186).png?raw=true)
## Consejos de Cocina 
 Permite al usuario dejar una cr√≠tica o consejo sobre la receta 
publicada
 ![](https://github.com/Mishell-0/GastroVerse/blob/main/Captura%20de%20pantalla%20(188).png?raw=true)
## Eventos Especiales
Esta colecci√≥n es √∫til para gestionar y mostrar eventos especiales.
 ![](https://github.com/Mishell-0/GastroVerse/blob/main/Captura%20de%20pantalla%202024-01-31%20113602.png?raw=true)
## Favoritos
 Permite al usuario marcar una receta como Fa Con nuestro usuario y contrase√±a podremos ingresar a la aplicaci√≥n indicando la vorito.
  ![](https://github.com/Mishell-0/GastroVerse/blob/main/Captura%20de%20pantalla%202024-01-31%20113607.png?raw=true)
## Historial
 Permite al usuario guardar las recetas vistas.
 
  ![](https://github.com/Mishell-0/GastroVerse/blob/main/Captura%20de%20pantalla%202024-01-31%20113617.png?raw=true)
## Ingredientes
Nos permite ver los ingredientes necesarios junto con sus calor√≠as para 
la elaboraci√≥n de nuestra receta.
 ![](https://github.com/Mishell-0/GastroVerse/blob/main/INGREDIENTES.png?raw=true)
## Intentos
 Indica al usuario el tipo de actividad y dependiendo, mandar√° un mensaje de inicio exitoso o caso contrario un mensaje fallido.
  ![](https://github.com/Mishell-0/GastroVerse/blob/main/Captura%20de%20pantalla%202024-01-31%20113634.png?raw=true)
## Interacciones 
 Indica la interacci√≥n realizada por el usuario a la hora y fecha exacta
  ![](https://github.com/Mishell-0/GastroVerse/blob/main/Captura%20de%20pantalla%202024-01-31%20113640.png?raw=true)
## Sesiones
 Con nuestro usuario y contrase√±a podremos ingresar a la aplicaci√≥n indicando la fecha y hora, dispositivo por el cual se inici√≥ sesi√≥n.
  ![](https://github.com/Mishell-0/GastroVerse/blob/main/SESIONES.png?raw=true)
 ## Membresias
  Indica el tipo de membres√≠a, el precio y los beneficios que se otorga al 
usuario.
 ![](https://github.com/Mishell-0/GastroVerse/blob/main/Captura%20de%20pantalla%202024-01-31%20113651.png?raw=true)
 ## Multimedia
  Colecci√≥n necesaria para dar una vista previa tanto de los ingredientes 
como la receta.
 ![](https://github.com/Mishell-0/GastroVerse/blob/main/Captura%20de%20pantalla%202024-01-31%20113656.png?raw=true)
 ## Notificaciones
  Env√≠a un tipo de notificaci√≥n al usuario detectando si fue le√≠da.
   ![](https://github.com/Mishell-0/GastroVerse/blob/main/NOTIFICACIONES.png?raw=true)
 ## Permisos
 Indica el tipo de permiso para poder acceder al sistema y obtener acciones 
diferentes.
 ![](https://github.com/Mishell-0/GastroVerse/blob/main/Captura%20de%20pantalla%202024-01-31%20113707.png?raw=true)
## Perfiles
 Indica si el perfil de un usuario es publico o privado
 ![](https://github.com/Mishell-0/GastroVerse/blob/main/PERFILES.png?raw=true)
 
 ## Recetas
  Indica el paso a paso y el tiempo de preparaci√≥n de cada receta que haya 
subido cada usuario.
 ![](https://github.com/Mishell-0/GastroVerse/blob/main/RECETAS.png?raw=true)
 ## Restricciones Dieteticas
  Indica al usuario la restricci√≥n de la receta.
  
   ![](https://github.com/Mishell-0/GastroVerse/blob/main/Captura%20de%20pantalla%202024-01-31%20113716.png?raw=true)
## Roles
  Indica que rol cumple en el aplicativo cada usuario
  
   ![](https://github.com/Mishell-0/GastroVerse/blob/main/ROLES.png?raw=true)
   
 ## Tendencias
 Indica la receta m√°s popular y destacada del momento.
 
  ![](https://github.com/Mishell-0/GastroVerse/blob/main/Captura%20de%20pantalla%202024-01-31%20113722.png?raw=true)
 ## Usuarios
  Datos de usuarios para poder autentificarse.
  
   ![](https://github.com/Mishell-0/GastroVerse/blob/main/USUARIOS.png?raw=true)
 ## Valoraciones
  Permite calificar las receta
  
   ![](https://github.com/Mishell-0/GastroVerse/blob/main/Captura%20de%20pantalla%202024-01-31%20113732.png?raw=true)

   
#### CONSULTAS
1.Obtener todas las recetas que contengan un ingrediente espec√≠fico.

	db.Recetas.find({ ingredientes: { $elemMatch: { nombre: "Pollo" } } })

2.Encontrar las recetas que tengan m√°s de 500 calor√≠as y est√©n ordenadas por tiempo de preparaci√≥n descendente. 

	db.Recetas.find({ calorias: { $gt: 500 } }).sort({ tiempo_preparacion: -1 })
3.Mostrar las recetas que fueron creadas por usuarios con un rol de chef.

	db.Recetas.aggregate([
	  {
    	$lookup: {
      	from: "Usuarios",
      	localField: "creador",
      	foreignField: "_id",
      	as: "creador_info"
    	}
  	},
  	{
    	$unwind: "$creador_info"
  	},
  	{
    	$lookup: {
      	from: "Roles",
     	 localField: "creador_info.rol",
      	foreignField: "_id",
      	as: "rol_info"
    	}
  	},
  	{
    	$unwind: "$rol_info"
  	},
  	{
    	$match: {
      	"rol_info.nombre": "Chef"
    	}
  	}
	])

4.Buscar las recetas que tengan al menos 3 pasos en su proceso de preparaci√≥n. 

	db.Recetas.find({ $expr: { $gte: [{ $size: "$pasos" }, 3] } })

5.Obtener las recetas que contengan al menos dos etiquetas espec√≠ficas.

	db.Recetas.find({ etiquetas: { $all: ["Ensalada", "Saludable"] } })

6.Encontrar las recetas m√°s recientes creadas por usuarios con un nivel de habilidad de cocina superior a 3. 

	db.Recetas.aggregate([
  	{
    	$lookup: {
          	from: "Usuarios",
          	localField: "creador",
          	foreignField: "_id",
          	as: "creador_info"
        	}
      	},
      	{
        	$match: {
          	"creador_info.nivel_habilidad": { $gt: 3 }
        	}
      	},
      	{
        	$sort: { fecha_actualizacion: -1 }
      	}
    	])
7.Mostrar las recetas que hayan sido actualizadas en los √∫ltimos 7 d√≠as. 

 	var fecha_limite = new Date()
    	fecha_limite.setDate(fecha_limite.getDate() - 7)
    	db.Recetas.find({ fecha_actualizacion: { $gte: fecha_limite } })
8.Buscar las recetas que tengan un nombre que coincida con un patr√≥n de expresi√≥n regular.

        	db.Recetas.find({ titulo: { $regex: /Ensalada/ } }) 

9.Obtener las recetas que tengan un tiempo de preparaci√≥n menor o igual a 30 minutos y est√©n marcadas como aptas para vegetarianos. 

    	db.Recetas.find({ tiempo_preparacion: { $lte: 30 }, vegetariana:¬†true¬†})
       
10.Encontrar las recetas que tengan m√°s de 5 comentarios y ordenarlas por el n√∫mero de comentarios descendente. 

    	db.Recetas.find({ "comentarios.5": { $exists: true } }).sort({ "comentarios": -1 })

####Consultas para M√≥dulos de Login, Sesiones, Autenticaci√≥n, Roles, Notificaciones, Perfiles de Usuario, etc.: 
12.Obtener la informaci√≥n del perfil de usuario, incluyendo su historial de inicio de sesi√≥n, notificaciones y roles. 

    	db.Usuarios.aggregate([
    	{
    	$lookup: {
    	from: "Sesiones",
    	localField: "_id",
    	foreignField: "usuario",
    	as: "historial_inicio_sesion"
    	}
    	},
    	{
    	$lookup: {
    	from: "Roles",
    	localField: "roles",
    	foreignField: "_id",
    	as: "roles_info"
    	}
    	},
    	{
    	$lookup: {
    	from: "Notificaciones",
    	localField: "_id",
    	foreignField: "usuario",
    	as: "notificaciones"
    	}
    	}
    	])
13.Buscar usuarios que tengan m√°s de 3 notificaciones no le√≠das.

    	db.Usuarios.aggregate([
    	{
    	$unwind: "$notificaciones" // Desdobla el array de notificaciones
    	},
    	{
    	$match: {
    	"notificaciones.leida": false
    	}
    	},
    	{
    	$group: {
    	_id: "$_id",
    	total_notificaciones_no_leidas: { $sum: 1 } // Contador de notificaciones     	no le√≠das por usuario
    	}
    	},
    	{
    	$match: {
    	total_notificaciones_no_leidas: { $gt: 3 } // Filtra aquellos con m√°s de 3      	notificaciones no le√≠das
    	}
    	},
    	{
    	$project: {
    	_id: 1,
    	nombre: 1
    	}
    	}
    	])

 14.Mostrar los usuarios que tengan un rol espec√≠fico y hayan iniciado sesi√≥n en las √∫ltimas 24 horas. 
 
    	var fecha_limite = new Date()
    	fecha_limite.setDate(fecha_limite.getDate() - 1)
    	db.Usuarios.aggregate([
    	{
    	$lookup: {
    	from: "Sesiones",
    	localField: "_id",
    	foreignField: "usuario",
    	as: "historial_inicio_sesion"
    	}
    	},
    	{
    	$match: {
    	"historial_inicio_sesion.fecha_inicio": { $gte: fecha_limite },
    	"roles_info.nombre": "Usuario" 
    	}
    	}
    	])
15. Encontrar los usuarios que tengan un nivel de autenticaci√≥n de dos factores activado. 

    	db.Usuarios.find({ "autenticacion_dos_factores": true })
16. Obtener la lista de roles disponibles en el sistema, ordenados alfab√©ticamente. 

    	db.Roles.find().sort({ "nombre": 1 })
17. Buscar usuarios que tengan una sesi√≥n activa en m√°s de un dispositivo. 

    	db.Usuarios.find({
      	"historial_inicio_sesion": {
        	$elemMatch: {
          	"dispositivos": { $exists: true, $gt: 1 }
        	}
     	 }
    	})

